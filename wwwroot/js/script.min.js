"use trict";function setCookie(n,t,i){var u="",r;i&&(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toUTCString());document.cookie=n+"="+(t||"")+u+";"}function getCookie(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return null}function eraseCookie(n){document.cookie=n+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function remove_cookie(){eraseCookie("USER");eraseCookie("KEY");eraseCookie("IV")}function sign_out(){remove_cookie();window.location.href="/"}function update_token(n){setCookie("USER",n.value,365);setCookie("KEY",n.key,365);setCookie("IV",n.iv,365)}function createCustomAlert(n){(d=document,d.getElementById("modalContainer"))||(mObj=d.getElementsByTagName("body")[0].appendChild(d.createElement("div")),mObj.id="modalContainer",mObj.style.height=d.documentElement.scrollHeight+"px",alertObj=mObj.appendChild(d.createElement("div")),alertObj.id="alertBox",d.all&&!window.opera&&(alertObj.style.top=document.documentElement.scrollTop+"px"),alertObj.style.left=(d.documentElement.scrollWidth-alertObj.offsetWidth)/2+"px",alertObj.style.visiblity="visible",h1=alertObj.appendChild(d.createElement("h1")),h1.appendChild(d.createTextNode(ALERT_TITLE)),msg=alertObj.appendChild(d.createElement("p")),msg.innerHTML=n,btn=alertObj.appendChild(d.createElement("a")),btn.id="closeBtn",btn.appendChild(d.createTextNode(ALERT_BUTTON_TEXT)),btn.focus(),btn.onclick=function(){return removeCustomAlert(),!1},alertObj.style.display="block")}function removeCustomAlert(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("modalContainer"))}function Captcha(){for(var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],i,t=0;t<6;t++)var r=n[Math.floor(Math.random()*n.length)],u=n[Math.floor(Math.random()*n.length)],f=n[Math.floor(Math.random()*n.length)],e=n[Math.floor(Math.random()*n.length)],o=n[Math.floor(Math.random()*n.length)],s=n[Math.floor(Math.random()*n.length)],h=n[Math.floor(Math.random()*n.length)];i=r+" "+u+"  "+f+" "+e+" "+o+" "+s+" "+h;document.getElementById("mainCaptcha").innerHTML=i;document.getElementById("mainCaptcha").value=i}function ValidCaptcha(){var n=removeSpaces(document.getElementById("mainCaptcha").value),t=removeSpaces(document.getElementById("txtInput").value);return n==t?!0:!1}function removeSpaces(n){return n.split(" ").join("")}function validation_phone(n){return n.match(/(84|0[3|5|7|8|9])+([0-9]{8})\b/g)?!0:!1}var connection=(new signalR.HubConnectionBuilder).withUrl("/KenoHub").build(),connectionAccount=(new signalR.HubConnectionBuilder).withUrl("/AccountHub").build(),ALERT_TITLE="Thông Báo",ALERT_BUTTON_TEXT="OK",global_token={value:getCookie("USER"),key:getCookie("KEY"),iv:getCookie("IV")},app;document.getElementById&&(window.alert=function(n){createCustomAlert(n)});app=angular.module("STU",[]).run();app.controller("HomeController",["$scope","$timeout","$http",function(n){n.PlayNowModal=!1;n.KenoModal=!1;n.ChanLeModal=!1;n.loading=!0;n.selectChanLe=0;n.text="QUAY SỐ BẮT ĐẦU SAU";connection.q=="Disconnected"&&connection.start().then(function(){connection.invoke("GetKeno",global_token).catch(function(n){return console.error(n.toString())})}).catch(function(n){return console.error(n.toString())});var t=()=>{for(var t=document.getElementsByClassName("chanle-select-span"),n=0;n<t.length;n++)t[n].classList.remove("modal-chanle-active")};n.ChanLeSelected=i=>{var r;t();i==1?(r=document.getElementsByClassName("modal-chanle-le"),r[0].classList.add("modal-chanle-active")):(r=document.getElementsByClassName("modal-chanle-chan"),r[0].classList.add("modal-chanle-active"));n.selectChanLe=i};n.PlayNow=()=>{n.PlayNowModal=!0};n.ClosePlayNow=()=>{n.PlayNowModal=!1};n.goBetNumber=()=>{n.PlayNowModal=!1,n.KenoModal=!0};n.goBetChanLe=()=>{n.PlayNowModal=!1,n.ChanLeModal=!0};n.CloseKeno=()=>{n.KenoModal=!1};n.CloseChanLe=()=>{n.ChanLeModal=!1};n.goAcceptKeno=()=>{var i=n.Keno_number,t=n.Keno_Coin;if(i==undefined||i==null){alert("Vui lòng chọn số muốn cược.");return}if(t==undefined||t==null){alert("Vui lòng chọn số <b>Xu<\/b> muốn cược.");return}if(t==0){alert("Vui lòng đặt <b>Xu<\/b> lớn hơn 0.");return}connection.invoke("KenoBet",global_token,n.KenoCurrent.id,i,t).catch(function(n){return console.error(n.toString())})};n.goAcceptChanLe=()=>{var i=n.selectChanLe,t=n.ChanLe_Coin;if(i==0){alert("Vui lòng chọn chẵn hoặc lẻ.");return}if(t==undefined||t==null){alert("Vui lòng chọn số <b>Xu<\/b> muốn cược.");return}if(t==0){alert("Vui lòng đặt <b>Xu<\/b> lớn hơn 0.");return}connection.invoke("ChanLeBet",global_token,n.ChanLeCurrent.id,i,t).catch(function(n){return console.error(n.toString())})};connection.on("ReceiveKeno",function(t,i,r,u,f){var e,o;update_token(t);n.KenoCurrent=i.data[0];n.KenoLast=i.data[1];n.ChanLeCurrent=r.data[0];n.ChanLeLast=r.data[1];n.datauser=i.data[1].users;n.datauserchanle=r.data[1].users;n.historyKeno=u;n.historyChanLe=f;n.text="VÒNG ĐẶT CƯỢC";i.data[0].result!=-1&&i.data[0].updatedusercoins&&(n.text="VÒNG KẾT QUẢ");i.data[0].result==-1||i.data[0].updatedusercoins||(i.data[0].result="??");e=i.data[0].countdown;n.minus=(e-e%60)/60;n.seconds=e%60;o=setInterval(function(){if(n.seconds=n.seconds-1,n.minus==0&&n.seconds==-1){clearInterval(o);e=0;connection.invoke("GetKeno",global_token).catch(function(n){return console.error(n.toString())});return}n.seconds==-1&&(n.seconds=59,n.minus=n.minus-1);n.minus!=0||i.data[0].updatedusercoins||(n.text="ĐỢI KẾT QUẢ");n.$apply()},1e3);n.loading=!1});connection.on("ReceiveKenoBet",function(n,t){if(alert(t.message),t.code==201){sign_out();return}update_token(n);t.code==200&&setTimeout(function(){window.location.reload()},2e3)});connection.on("ReceiveChanLeBet",function(n,t){if(alert(t.message),t.code==201){sign_out();return}update_token(n);t.code==200&&setTimeout(function(){window.location.reload()},2e3)})}]);app.controller("AccountController",["$scope","$timeout","$http",function(n){n.SendNotification=()=>{connectionAccount.invoke("SendNotification",n.NotificationTextSend).catch(function(n){return console.error(n.toString())})};n.goLogin=()=>{var t=n.Username,i=n.Password;connectionAccount.invoke("Login",t,i).catch(function(n){return console.error(n.toString())})};n.goRegister=()=>{var i=!0,t="",f=n.RGFullname,e=n.RGUsername,r=n.RGPhone,u=n.RGPassword,o=n.RGRePassword;if(!f||!e||!r||!u||!o){i=!1;t+="- Vui lòng điền đầy đủ thông tin.";alert(t);return}if(!validation_phone(r)){i=!1;t+="- Định dạng sđt không đúng.";alert(t);return}if(u!=o){i=!1;t+="- Xác nhận mật khẩu sai.";alert(t);return}if(!i){alert(t);return}connectionAccount.invoke("Register",f,r,e,u).catch(function(n){return console.error(n.toString())})}}]);app.controller("MenuController",["$scope","$timeout","$http",function(n){n.CloseMenu=()=>{var n=document.getElementsByClassName("menu-body");n[0].style.width="0px";n[0].style.left="-100%";setTimeout(function(){var n=document.getElementsByClassName("menu-overload");n[0].setAttribute("hidden","hidden")},500)};n.goAccount=()=>{window.location.href="/dang-nhap"};n.LoadMenu=()=>{var n=document.getElementsByClassName("menu-overload");n[0].removeAttribute("hidden");setTimeout(function(){var n=document.getElementsByClassName("menu-body");n[0].style.width="270px";n[0].style.left="0px"},100)};connectionAccount.on("ReceiveNotification",function(t){n.Notification=!0;n.NotificationText=t.message;var i=document.getElementById("marquee");i.start();setTimeout(function(){n.Notification=!1;n.$apply()},3e4);n.$apply()})}]);app.controller("HeaderController",["$scope","$timeout","$http",function(n){n.LoginModal=!1;n.RegisterModal=!1;n.Notification=!1;connectionAccount.q=="Disconnected"&&connectionAccount.start().then(function(){}).catch(function(n){return console.error(n.toString())});n.LoadMenu=()=>{var n=document.getElementsByClassName("menu-overload");n[0].removeAttribute("hidden");setTimeout(function(){var n=document.getElementsByClassName("menu-body");n[0].style.width="270px";n[0].style.left="0px"},100)};n.Login=()=>{n.LoginModal=!0,n.RegisterModal=!1};n.CloseLogin=()=>{n.LoginModal=!1};n.goLogin=()=>{var t=n.Username,i=n.Password;connectionAccount.invoke("Login",t,i).catch(function(n){return console.error(n.toString())})};n.Register=()=>{n.RegisterModal=!0,n.LoginModal=!1};n.CloseRegister=()=>{n.RegisterModal=!1};n.goRegister=()=>{var i=!0,t="",f=n.RGFullname,e=n.RGUsername,r=n.RGPhone,u=n.RGPassword,o=n.RGRePassword;if(!f||!e||!r||!u||!o){i=!1;t+="- Vui lòng điền đầy đủ thông tin.";alert(t);return}if(!validation_phone(r)){i=!1;t+="- Định dạng sđt không đúng.";alert(t);return}if(u!=o){i=!1;t+="- Xác nhận mật khẩu sai.";alert(t);return}if(!i){alert(t);return}connectionAccount.invoke("Register",f,r,e,u).catch(function(n){return console.error(n.toString())})};n.goKeno=()=>{connectionAccount.invoke("LoginStatus",global_token).catch(function(n){return console.error(n.toString())})};connectionAccount.on("ReceiveAccount",function(n,t){if(n.code==200){update_token(t);window.location.href="/";return}alert("tài khoản hoặc mật khẩu không đúng.")});connectionAccount.on("CheckLoginStatus",function(t){if(t.code==200){window.location.href="/doan-so-chan-le";return}n.LoginModal=!0;n.RegisterModal=!1;n.$apply()});connectionAccount.on("ReceiveRegister",function(n,t){if(n.code==200){update_token(t);window.location.href="/";return}alert(n.message)})}]);